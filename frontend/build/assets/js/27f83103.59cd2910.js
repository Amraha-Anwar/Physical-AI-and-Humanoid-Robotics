"use strict";(globalThis.webpackChunkphysical_ai_humanoid_robotics_book=globalThis.webpackChunkphysical_ai_humanoid_robotics_book||[]).push([[683],{5680:(e,n,t)=>{t.d(n,{xA:()=>u,yg:()=>g});var i=t(6540);function o(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function r(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);n&&(i=i.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),t.push.apply(t,i)}return t}function a(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?r(Object(t),!0).forEach(function(n){o(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):r(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}function l(e,n){if(null==e)return{};var t,i,o=function(e,n){if(null==e)return{};var t,i,o={},r=Object.keys(e);for(i=0;i<r.length;i++)t=r[i],n.indexOf(t)>=0||(o[t]=e[t]);return o}(e,n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(i=0;i<r.length;i++)t=r[i],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(o[t]=e[t])}return o}var s=i.createContext({}),p=function(e){var n=i.useContext(s),t=n;return e&&(t="function"==typeof e?e(n):a(a({},n),e)),t},u=function(e){var n=p(e.components);return i.createElement(s.Provider,{value:n},e.children)},d="mdxType",m={inlineCode:"code",wrapper:function(e){var n=e.children;return i.createElement(i.Fragment,{},n)}},c=i.forwardRef(function(e,n){var t=e.components,o=e.mdxType,r=e.originalType,s=e.parentName,u=l(e,["components","mdxType","originalType","parentName"]),d=p(t),c=o,g=d["".concat(s,".").concat(c)]||d[c]||m[c]||r;return t?i.createElement(g,a(a({ref:n},u),{},{components:t})):i.createElement(g,a({ref:n},u))});function g(e,n){var t=arguments,o=n&&n.mdxType;if("string"==typeof e||o){var r=t.length,a=new Array(r);a[0]=c;var l={};for(var s in n)hasOwnProperty.call(n,s)&&(l[s]=n[s]);l.originalType=e,l[d]="string"==typeof e?e:o,a[1]=l;for(var p=2;p<r;p++)a[p]=t[p];return i.createElement.apply(null,a)}return i.createElement.apply(null,t)}c.displayName="MDXCreateElement"},6863:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>s,contentTitle:()=>a,default:()=>m,frontMatter:()=>r,metadata:()=>l,toc:()=>p});var i=t(8168),o=(t(6540),t(5680));const r={sidebar_position:3,title:"Robot Modeling (URDF)"},a="Robot Modeling (URDF)",l={unversionedId:"module1/urdf-rviz2",id:"module1/urdf-rviz2",title:"Robot Modeling (URDF)",description:"Learning Objectives",source:"@site/docs/module1/03-urdf-rviz2.mdx",sourceDirName:"module1",slug:"/module1/urdf-rviz2",permalink:"/docs/module1/urdf-rviz2",draft:!1,editUrl:"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/module1/03-urdf-rviz2.mdx",tags:[],version:"current",sidebarPosition:3,frontMatter:{sidebar_position:3,title:"Robot Modeling (URDF)"},sidebar:"tutorialSidebar",previous:{title:"Packages and rclpy",permalink:"/docs/module1/packages-rclpy"},next:{title:"Gazebo Simulation Setup",permalink:"/docs/module2/gazebo-setup"}},s={},p=[{value:"Learning Objectives",id:"learning-objectives",level:2},{value:"Introduction to URDF",id:"introduction-to-urdf",level:2},{value:"1. Creating a Simple Humanoid Segment (Xacro)",id:"1-creating-a-simple-humanoid-segment-xacro",level:2},{value:"Convert Xacro to URDF",id:"convert-xacro-to-urdf",level:3},{value:"2. Visualizing the Model in RViz2",id:"2-visualizing-the-model-in-rviz2",level:2},{value:"3. The Transform Tree (TF2)",id:"3-the-transform-tree-tf2",level:2},{value:"Key concepts of TF2:",id:"key-concepts-of-tf2",level:3},{value:"Conclusion",id:"conclusion",level:2}],u={toc:p},d="wrapper";function m({components:e,...n}){return(0,o.yg)(d,(0,i.A)({},u,n,{components:e,mdxType:"MDXLayout"}),(0,o.yg)("h1",{id:"robot-modeling-urdf"},"Robot Modeling (URDF)"),(0,o.yg)("h2",{id:"learning-objectives"},"Learning Objectives"),(0,o.yg)("p",null,"Upon completing this chapter, you will be able to:"),(0,o.yg)("ul",null,(0,o.yg)("li",{parentName:"ul"},"Understand the purpose and structure of the Unified Robot Description Format (URDF)."),(0,o.yg)("li",{parentName:"ul"},"Define a basic robot structure using ",(0,o.yg)("inlineCode",{parentName:"li"},"link")," and ",(0,o.yg)("inlineCode",{parentName:"li"},"joint")," elements in URDF/Xacro."),(0,o.yg)("li",{parentName:"ul"},"Create a simple Xacro file to modularize URDF definitions."),(0,o.yg)("li",{parentName:"ul"},"Visualize your robot model in ROS 2's ",(0,o.yg)("inlineCode",{parentName:"li"},"RViz2"),"."),(0,o.yg)("li",{parentName:"ul"},"Grasp the concept of the Transform Tree (TF2) and its importance for coordinate frame management.")),(0,o.yg)("h2",{id:"introduction-to-urdf"},"Introduction to URDF"),(0,o.yg)("p",null,"The ",(0,o.yg)("strong",{parentName:"p"},"Unified Robot Description Format (URDF)")," is an XML-based file format used in ROS to describe all aspects of a robot model. It specifies the robot's kinematic and dynamic properties, visual appearance, and collision geometry. URDF is essential for simulating robots, path planning, and performing motion control."),(0,o.yg)("p",null,"A URDF file primarily consists of two main elements:"),(0,o.yg)("ul",null,(0,o.yg)("li",{parentName:"ul"},(0,o.yg)("strong",{parentName:"li"},(0,o.yg)("inlineCode",{parentName:"strong"},"<link>")),": Represents a rigid body segment of the robot (e.g., a wheel, a torso, an arm segment). It defines mass, inertia, visual, and collision properties."),(0,o.yg)("li",{parentName:"ul"},(0,o.yg)("strong",{parentName:"li"},(0,o.yg)("inlineCode",{parentName:"strong"},"<joint>")),": Represents a connection between two links, defining their kinematic relationship and allowed motion. Joints typically have a type (e.g., ",(0,o.yg)("inlineCode",{parentName:"li"},"revolute"),", ",(0,o.yg)("inlineCode",{parentName:"li"},"continuous"),", ",(0,o.yg)("inlineCode",{parentName:"li"},"prismatic"),", ",(0,o.yg)("inlineCode",{parentName:"li"},"fixed"),").")),(0,o.yg)("p",null,"For complex robots, URDF files can become very large and repetitive. This is where ",(0,o.yg)("strong",{parentName:"p"},"Xacro")," (XML Macros) comes in handy. Xacro allows you to use macros, properties, and mathematical expressions within your robot descriptions, making them more modular, readable, and maintainable."),(0,o.yg)("h2",{id:"1-creating-a-simple-humanoid-segment-xacro"},"1. Creating a Simple Humanoid Segment (Xacro)"),(0,o.yg)("p",null,"Let's create a simplified URDF model for a humanoid's ",(0,o.yg)("inlineCode",{parentName:"p"},"torso")," connected to a ",(0,o.yg)("inlineCode",{parentName:"p"},"shoulder_link")," by a ",(0,o.yg)("inlineCode",{parentName:"p"},"shoulder_yaw_joint"),". This will demonstrate the core concepts of links and joints."),(0,o.yg)("p",null,"First, create a new ROS 2 package to hold our robot descriptions. We'll call it ",(0,o.yg)("inlineCode",{parentName:"p"},"humanoid_description"),"."),(0,o.yg)("pre",null,(0,o.yg)("code",{parentName:"pre",className:"language-bash"},"cd ~/colcon_ws/src\nros2 pkg create --build-type ament_python humanoid_description\n")),(0,o.yg)("p",null,"Inside ",(0,o.yg)("inlineCode",{parentName:"p"},"humanoid_description"),", create a ",(0,o.yg)("inlineCode",{parentName:"p"},"urdf")," directory:"),(0,o.yg)("pre",null,(0,o.yg)("code",{parentName:"pre",className:"language-bash"},"mkdir -p ~/colcon_ws/src/humanoid_description/urdf\ncd ~/colcon_ws/src/humanoid_description/urdf\n")),(0,o.yg)("p",null,"Now, create a Xacro file named ",(0,o.yg)("inlineCode",{parentName:"p"},"humanoid_segment.urdf.xacro"),":"),(0,o.yg)("pre",null,(0,o.yg)("code",{parentName:"pre",className:"language-xml"},'<?xml version="1.0"?>\n<robot name="humanoid_segment" xmlns:xacro="http://www.ros.org/wiki/xacro">\n\n  \x3c!-- Properties (constants) for easier modification --\x3e\n  <xacro:property name="M_PI" value="3.1415926535897931" />\n  <xacro:property name="torso_length" value="0.3" />\n  <xacro:property name="torso_radius" value="0.08" />\n  <xacro:property name="shoulder_link_length" value="0.2" />\n  <xacro:property name="shoulder_link_radius" value="0.03" />\n\n  \x3c!-- BASE LINK: Torso --\x3e\n  <link name="torso_link">\n    <visual>\n      <geometry>\n        <cylinder length="${torso_length}" radius="${torso_radius}"/>\n      </geometry>\n      <material name="blue">\n        <color rgba="0 0 0.8 1"/>\n      </material>\n    </visual>\n    <collision>\n      <geometry>\n        <cylinder length="${torso_length}" radius="${torso_radius}"/>\n      </geometry>\n    </collision>\n    <inertial>\n      <mass value="5.0"/>\n      <inertia ixx="0.05" ixy="0.0" ixz="0.0" iyy="0.05" iyz="0.0" izz="0.01"/>\n    </inertial>\n  </link>\n\n  \x3c!-- JOINT: Connects torso_link to shoulder_link --\x3e\n  <joint name="shoulder_yaw_joint" type="revolute">\n    <parent link="torso_link"/>\n    <child link="shoulder_link"/>\n    <origin xyz="0 0 ${torso_length/2}" rpy="0 0 0"/> \x3c!-- Top center of torso_link --\x3e\n    <axis xyz="0 0 1"/> \x3c!-- Rotates around Z-axis (yaw) --\x3e\n    <limit lower="-${M_PI/2}" upper="${M_PI/2}" effort="100" velocity="10"/>\n  </joint>\n\n  \x3c!-- CHILD LINK: Shoulder --\x3e\n  <link name="shoulder_link">\n    <visual>\n      <geometry>\n        <cylinder length="${shoulder_link_length}" radius="${shoulder_link_radius}"/>\n      </geometry>\n      <origin xyz="0 0 ${shoulder_link_length/2}" rpy="0 0 0"/> \x3c!-- Offset for visualization --\x3e\n      <material name="green">\n        <color rgba="0 0.8 0 1"/>\n      </material>\n    </visual>\n    <collision>\n      <geometry>\n        <cylinder length="${shoulder_link_length}" radius="${shoulder_link_radius}"/>\n      </geometry>\n      <origin xyz="0 0 ${shoulder_link_length/2}" rpy="0 0 0"/>\n    </collision>\n    <inertial>\n      <mass value="0.5"/>\n      <inertia ixx="0.001" ixy="0.0" ixz="0.0" iyy="0.001" iyz="0.0" izz="0.0001"/>\n    </inertial>\n  </link>\n\n</robot>\n')),(0,o.yg)("p",null,(0,o.yg)("em",{parentName:"p"},"File: ",(0,o.yg)("inlineCode",{parentName:"em"},"humanoid_segment.urdf.xacro"))),(0,o.yg)("p",null,"This Xacro file defines two links (",(0,o.yg)("inlineCode",{parentName:"p"},"torso_link"),", ",(0,o.yg)("inlineCode",{parentName:"p"},"shoulder_link"),") and one ",(0,o.yg)("inlineCode",{parentName:"p"},"revolute")," joint (",(0,o.yg)("inlineCode",{parentName:"p"},"shoulder_yaw_joint"),") connecting them. The ",(0,o.yg)("inlineCode",{parentName:"p"},"origin")," element in the joint defines the position and orientation of the ",(0,o.yg)("inlineCode",{parentName:"p"},"child")," link relative to the ",(0,o.yg)("inlineCode",{parentName:"p"},"parent")," link's origin."),(0,o.yg)("h3",{id:"convert-xacro-to-urdf"},"Convert Xacro to URDF"),(0,o.yg)("p",null,"Before visualizing, Xacro files must be processed into a plain URDF file:"),(0,o.yg)("pre",null,(0,o.yg)("code",{parentName:"pre",className:"language-bash"},"ros2 run xacro xacro humanoid_segment.urdf.xacro > humanoid_segment.urdf\n")),(0,o.yg)("p",null,"This command generates ",(0,o.yg)("inlineCode",{parentName:"p"},"humanoid_segment.urdf")," in the same directory."),(0,o.yg)("h2",{id:"2-visualizing-the-model-in-rviz2"},"2. Visualizing the Model in RViz2"),(0,o.yg)("p",null,(0,o.yg)("strong",{parentName:"p"},"RViz2")," is a 3D visualization tool for ROS 2 that allows you to view sensor data, robot models, and planning results."),(0,o.yg)("ol",null,(0,o.yg)("li",{parentName:"ol"},(0,o.yg)("p",{parentName:"li"},(0,o.yg)("strong",{parentName:"p"},"Install ",(0,o.yg)("inlineCode",{parentName:"strong"},"joint_state_publisher_gui"),":"),"\nThis tool allows you to manually control the joint angles of your robot model for visualization purposes."),(0,o.yg)("pre",{parentName:"li"},(0,o.yg)("code",{parentName:"pre",className:"language-bash"},"sudo apt install ros-humble-joint-state-publisher-gui ros-humble-rviz2 -y\n"))),(0,o.yg)("li",{parentName:"ol"},(0,o.yg)("p",{parentName:"li"},(0,o.yg)("strong",{parentName:"p"},"Launch ",(0,o.yg)("inlineCode",{parentName:"strong"},"RViz2")," and ",(0,o.yg)("inlineCode",{parentName:"strong"},"robot_state_publisher"),":"),"\nYou'll need ",(0,o.yg)("inlineCode",{parentName:"p"},"robot_state_publisher")," to publish the robot's state (including its URDF description and joint states) to the ROS 2 system."),(0,o.yg)("p",{parentName:"li"},"Open a terminal, navigate to your workspace, source it, and run:"),(0,o.yg)("pre",{parentName:"li"},(0,o.yg)("code",{parentName:"pre",className:"language-bash"},"cd ~/colcon_ws\nsource install/setup.bash\n\nros2 launch urdf_tutorial display.launch.py model:=src/humanoid_description/urdf/humanoid_segment.urdf\n")),(0,o.yg)("p",{parentName:"li"},"(Note: ",(0,o.yg)("inlineCode",{parentName:"p"},"urdf_tutorial")," is a standard package that provides ",(0,o.yg)("inlineCode",{parentName:"p"},"display.launch.py")," for easily viewing URDFs)."),(0,o.yg)("p",{parentName:"li"},"If you don't have ",(0,o.yg)("inlineCode",{parentName:"p"},"urdf_tutorial")," installed, you can launch ",(0,o.yg)("inlineCode",{parentName:"p"},"RViz2")," and ",(0,o.yg)("inlineCode",{parentName:"p"},"robot_state_publisher")," manually:"),(0,o.yg)("pre",{parentName:"li"},(0,o.yg)("code",{parentName:"pre",className:"language-bash"},'# Terminal 1: Launch RViz2\nrviz2\n\n# Terminal 2: Launch robot_state_publisher and joint_state_publisher_gui\ncd ~/colcon_ws\nsource install/setup.bash\nros2 run robot_state_publisher robot_state_publisher --ros-args -p robot_description:="<command_to_get_urdf_content>"\n# A simpler way if you have the file locally:\nros2 run robot_state_publisher robot_state_publisher --ros-args -p robot_description:="$(cat src/humanoid_description/urdf/humanoid_segment.urdf)"\n\nros2 run joint_state_publisher_gui joint_state_publisher_gui\n')),(0,o.yg)("p",{parentName:"li"},"In ",(0,o.yg)("inlineCode",{parentName:"p"},"RViz2"),":"),(0,o.yg)("ul",{parentName:"li"},(0,o.yg)("li",{parentName:"ul"},"Add a ",(0,o.yg)("inlineCode",{parentName:"li"},"RobotModel")," display, and ensure its ",(0,o.yg)("inlineCode",{parentName:"li"},"Description Source")," is set to ",(0,o.yg)("inlineCode",{parentName:"li"},"Robot Description")," (default)."),(0,o.yg)("li",{parentName:"ul"},"Add a ",(0,o.yg)("inlineCode",{parentName:"li"},"TF")," display to see the coordinate frames."),(0,o.yg)("li",{parentName:"ul"},"In the ",(0,o.yg)("inlineCode",{parentName:"li"},"joint_state_publisher_gui")," window, you should see a slider for ",(0,o.yg)("inlineCode",{parentName:"li"},"shoulder_yaw_joint"),". Moving this slider will rotate the ",(0,o.yg)("inlineCode",{parentName:"li"},"shoulder_link")," relative to the ",(0,o.yg)("inlineCode",{parentName:"li"},"torso_link")," in ",(0,o.yg)("inlineCode",{parentName:"li"},"RViz2"),".")))),(0,o.yg)("h2",{id:"3-the-transform-tree-tf2"},"3. The Transform Tree (TF2)"),(0,o.yg)("p",null,"The ",(0,o.yg)("strong",{parentName:"p"},"Transform Tree (TF2)"),' is a crucial ROS 2 concept that keeps track of the relationships between all coordinate frames in your robot system. For any given time, TF2 can answer questions like: "What is the pose of the camera relative to the robot\'s base?" or "Where is the robot\'s end-effector in the world frame?".'),(0,o.yg)("p",null,"In our ",(0,o.yg)("inlineCode",{parentName:"p"},"humanoid_segment.urdf.xacro"),", each ",(0,o.yg)("inlineCode",{parentName:"p"},"link")," defines its own coordinate frame. The ",(0,o.yg)("inlineCode",{parentName:"p"},"joint")," elements define the transformations between these frames. When ",(0,o.yg)("inlineCode",{parentName:"p"},"robot_state_publisher")," processes the URDF, it publishes these transformations to the ROS 2 system."),(0,o.yg)("h3",{id:"key-concepts-of-tf2"},"Key concepts of TF2:"),(0,o.yg)("ul",null,(0,o.yg)("li",{parentName:"ul"},(0,o.yg)("strong",{parentName:"li"},"Frames"),": Every ",(0,o.yg)("inlineCode",{parentName:"li"},"link")," has an associated coordinate frame."),(0,o.yg)("li",{parentName:"ul"},(0,o.yg)("strong",{parentName:"li"},"Transforms"),": The relationships (translation and rotation) between two frames. These are represented by ",(0,o.yg)("inlineCode",{parentName:"li"},"tf2_msgs/msg/TFMessage"),"."),(0,o.yg)("li",{parentName:"ul"},(0,o.yg)("strong",{parentName:"li"},(0,o.yg)("inlineCode",{parentName:"strong"},"tf2_ros")),": The client library for TF2, allowing you to query transforms between any two frames at any point in time."),(0,o.yg)("li",{parentName:"ul"},(0,o.yg)("strong",{parentName:"li"},"Tree structure"),": All frames form a tree structure, where each frame has one parent, except for the root frame.")),(0,o.yg)("p",null,"You can visualize the TF tree using ",(0,o.yg)("inlineCode",{parentName:"p"},"rqt_tf_tree"),":"),(0,o.yg)("pre",null,(0,o.yg)("code",{parentName:"pre",className:"language-bash"},"ros2 run rqt_tf_tree rqt_tf_tree\n")),(0,o.yg)("p",null,"This tool will graphically display the parent-child relationships between your robot's links as defined by the URDF and published by ",(0,o.yg)("inlineCode",{parentName:"p"},"robot_state_publisher"),". You should see ",(0,o.yg)("inlineCode",{parentName:"p"},"torso_link")," as the parent of ",(0,o.yg)("inlineCode",{parentName:"p"},"shoulder_link"),"."),(0,o.yg)("h2",{id:"conclusion"},"Conclusion"),(0,o.yg)("p",null,"You've learned how to describe your robot's physical structure using URDF/Xacro, enabling you to define links and joints. You then visualized this model in ",(0,o.yg)("inlineCode",{parentName:"p"},"RViz2")," and explored the critical concept of the Transform Tree (TF2), which manages coordinate frames essential for all robot navigation and manipulation tasks."),(0,o.yg)("hr",null),(0,o.yg)("p",null,(0,o.yg)("strong",{parentName:"p"},"Next Steps"),": With your core ROS 2 knowledge established, we will move on to simulating your robot in a virtual environment using Gazebo."))}m.isMDXComponent=!0}}]);